{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.tsx","webpack:///./node_modules/matrix-react-sdk/src/utils/MegolmExportEncryption.ts"],"names":["Phase","ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","state","passphrase1","passphrase2","setState","errStr","_t","startExport","onFinished","phrase","target","value","phase","Edit","componentWillUnmount","unmounted","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","logger","error","msg","friendlyText","Exporting","render","disableForm","className","title","onSubmit","onPassphraseFormSubmit","label","onChange","onPassphraseChange","autoFocus","size","disabled","onClick","onCancelClick","subtleCrypto","window","crypto","subtle","webkitSubtle","friendlyError","message","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","body","fileStr","TextDecoder","decode","Uint8Array","lineStart","lineEnd","indexOf","Error","line","slice","trim","HEADER_LINE","dataStart","undefined","dataEnd","base64","latin1String","atob","uint8Array","length","i","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","name","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","TextEncoder","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","getTime","aesProm","hmacProm","all","String","fromCharCode","apply","from","btoa"],"mappings":"8IA6BKA,E,8FAAK,SAALA,KAAK,YAALA,EAAK,uBAALA,MAAK,KAkBK,MAAMC,UAA4BC,IAAMC,UAGnDC,YAAYC,GACRC,MAAMD,GAAO,sBAHG,GAAK,kCAiBSE,IAC9BA,EAAGC,iBAEH,MAAMC,EAAaC,KAAKC,MAAMC,YAC9B,OAAIH,IAAeC,KAAKC,MAAME,aAC1BH,KAAKI,SAAS,CAAEC,OAAQC,YAAG,6BACpB,GAENP,GAKLC,KAAKO,YAAYR,IACV,IALHC,KAAKI,SAAS,CAAEC,OAAQC,YAAG,mCACpB,KAKd,yBAmCwBT,IACrBA,EAAGC,iBACHE,KAAKL,MAAMa,YAAW,IACf,IACV,8BAE4B,CAACX,EAAyCY,KACnET,KAAKI,SAAS,CACV,CAACK,GAASZ,EAAGa,OAAOC,UAtExBX,KAAKC,MAAQ,CACTW,MAAOtB,EAAMuB,KACbR,OAAQ,KACRH,YAAa,GACbC,YAAa,IAIdW,uBACHd,KAAKe,WAAY,EAoBbR,YAAYR,GAGhBiB,QAAQC,UAAUC,KAAK,IACZlB,KAAKL,MAAMwB,aAAaC,kBAChCF,KAAMG,GACEC,IACHC,KAAKC,UAAUH,GAAItB,IAExBmB,KAAMO,IACL,MAAMC,EAAO,IAAIC,KAAK,CAACF,GAAI,CACvBG,KAAM,gCAEVC,IAAUC,OAAOJ,EAAM,oBACvB1B,KAAKL,MAAMa,YAAW,KACvBuB,MAAOC,IAEN,GADAC,IAAOC,MAAM,4BAA6BF,GACtChC,KAAKe,UACL,OAEJ,MAAMoB,EAAMH,EAAEI,cAAgB9B,YAAG,iBACjCN,KAAKI,SAAS,CACVC,OAAQ8B,EACRvB,MAAOtB,EAAMuB,SAIrBb,KAAKI,SAAS,CACVC,OAAQ,KACRO,MAAOtB,EAAM+C,YAgBdC,SACH,MAAMC,EAAevC,KAAKC,MAAMW,QAAUtB,EAAM+C,UAEhD,OACI,kBAAC,IAAU,CAACG,UAAU,yBAClBhC,WAAYR,KAAKL,MAAMa,WACvBiC,MAAOnC,YAAG,qBAEV,0BAAMoC,SAAU1C,KAAK2C,wBACjB,yBAAKH,UAAU,qBACX,2BACMlC,YACE,iQAOR,2BACMA,YACE,2UAQR,yBAAKkC,UAAU,SACTxC,KAAKC,MAAMI,QAEjB,yBAAKmC,UAAU,+BACX,yBAAKA,UAAU,6BACX,kBAAC,IAAK,CACFI,MAAOtC,YAAG,oBACVK,MAAOX,KAAKC,MAAMC,YAClB2C,SAAUb,GAAKhC,KAAK8C,mBAAmBd,EAAG,eAC1Ce,WAAW,EACXC,KAAM,GACNpB,KAAK,WACLqB,SAAUV,KAGlB,yBAAKC,UAAU,6BACX,kBAAC,IAAK,CACFI,MAAOtC,YAAG,sBACVK,MAAOX,KAAKC,MAAME,YAClB0C,SAAUb,GAAKhC,KAAK8C,mBAAmBd,EAAG,eAC1CgB,KAAM,GACNpB,KAAK,WACLqB,SAAUV,OAK1B,yBAAKC,UAAU,qBACX,2BACIA,UAAU,oBACVZ,KAAK,SACLjB,MAAOL,YAAG,UACV2C,SAAUV,IAEd,4BAAQW,QAASlD,KAAKmD,cAAeF,SAAUV,GACzCjC,YAAG,iB,iCC/LjC,gGAsBA,MAAM8C,EAAeC,OAAOC,OAAOC,QAAUF,OAAOC,OAAOE,aAU3D,SAASC,EACLC,EAAiBtB,GAEjB,MAAO,CAAEsB,UAAStB,gBAGtB,SAASuB,IACL,OAAOrD,YAAG,sEAYPsD,eAAeC,EAAqBC,EAAmBC,GAC1D,MAAMC,EAiOV,SAA6BF,GAIzB,MAAMG,GAAU,IAAIC,aAAcC,OAAO,IAAIC,WAAWN,IAGxD,IAAIO,EAAY,EAEhB,OAAU,CACN,MAAMC,EAAUL,EAAQM,QAAQ,KAAMF,GACtC,GAAIC,EAAU,EACV,MAAM,IAAIE,MAAM,yBAEpB,MAAMC,EAAOR,EAAQS,MAAML,EAAWC,GAASK,OAK/C,GAFAN,EAAYC,EAAQ,EAEhBG,IAASG,EACT,MAIR,MAAMC,EAAYR,EAIlB,OAAU,CACN,MAAMC,EAAUL,EAAQM,QAAQ,KAAMF,GAEtC,GAzCa,sCAwCAJ,EAAQS,MAAML,EAAWC,EAAU,OAAIQ,EAAYR,GAASK,OAErE,MAGJ,GAAIL,EAAU,EACV,MAAM,IAAIE,MAAM,0BAIpBH,EAAYC,EAAQ,EAGxB,MAAMS,EAAUV,EAChB,OA+CJ,SAAsBW,GAElB,MAAMC,EAAe5B,OAAO6B,KAAKF,GAE3BG,EAAa,IAAIf,WAAWa,EAAaG,QAC/C,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAaG,OAAQC,IACrCF,EAAWE,GAAKJ,EAAaK,WAAWD,GAE5C,OAAOF,EAvDAI,CAAatB,EAAQS,MAAMG,EAAWE,IA7QhCS,CAAoB1B,GAC3B2B,EAAQC,IAAUC,MAAMF,MAG9B,GAAIzB,EAAKoB,OAAS,EACd,MAAM3B,EAAc,0BAChBnD,YAAG,gCAAiC,CAAEmF,WAI9C,GAAgB,IADAzB,EAAK,GAEjB,MAAMP,EAAc,sBAChBnD,YAAG,gCAAiC,CAAEmF,WAG9C,MAAMG,EAAmB5B,EAAKoB,OAAM,GACpC,GAAIQ,EAAmB,EACnB,MAAMnC,EAAc,0BAChBnD,YAAG,gCAAiC,CAAEmF,WAG9C,MAAMI,EAAO7B,EAAK8B,SAAS,EAAG,IACxBC,EAAK/B,EAAK8B,SAAS,GAAI,IACvBE,EAAahC,EAAK,KAAO,GAAKA,EAAK,KAAO,GAAKA,EAAK,KAAO,EAAIA,EAAK,IACpEiC,EAAajC,EAAK8B,SAAS,GAAI,GAAGF,GAClCM,EAAOlC,EAAK8B,UAAU,KAErBK,EAAQC,SAAiBC,EAAWR,EAAMG,EAAYjC,GACvDuC,EAAWtC,EAAK8B,SAAS,GAAI,IAEnC,IAAIS,EAgBAC,EAfJ,IACID,QAAgBnD,EAAaqD,OACzB,CAAEC,KAAM,QACRN,EACAF,EACAI,GAEN,MAAOtE,GACL,MAAMyB,EAAc,+BAAiCzB,EAAG2B,KAE5D,IAAK4C,EACD,MAAM9C,EAAc,gBAChBnD,YAAG,qDAIX,IACIkG,QAAkBpD,EAAauD,QAC3B,CACID,KAAM,UACNE,QAASb,EACTX,OAAQ,IAEZe,EACAF,GAEN,MAAOjE,GACL,MAAMyB,EAAc,gCAAkCzB,EAAG2B,KAG7D,OAAO,IAAIO,aAAcC,OAAO,IAAIC,WAAWoC,IAa5C5C,eAAeiD,EAClB/C,EACAC,EACA+C,GAGA,MAAMC,GADND,EAAUA,GAAW,IACKE,YAAc,IAElCnB,EAAO,IAAIzB,WAAW,IAC5Bf,OAAOC,OAAO2D,gBAAgBpB,GAE9B,MAAME,EAAK,IAAI3B,WAAW,IAC1Bf,OAAOC,OAAO2D,gBAAgBlB,GAK9BA,EAAG,IAAM,IAET,MAAOI,EAAQC,SAAiBC,EAAWR,EAAMkB,EAAWhD,GACtDmD,GAAc,IAAIC,aAAcC,OAAOtD,GAE7C,IAAImC,EACJ,IACIA,QAAmB7C,EAAaiE,QAC5B,CACIX,KAAM,UACNE,QAASb,EACTX,OAAQ,IAEZe,EACAe,GAEN,MAAOlF,GACL,MAAMyB,EAAc,gCAAkCzB,EAAG2B,KAG7D,MAAM2D,EAAc,IAAIlD,WAAW6B,GAC7BsB,EAAc,EAAE1B,EAAKT,OAAOW,EAAGX,OAAO,EAAEkC,EAAYlC,OAAO,GAC3DoC,EAAe,IAAIpD,WAAWmD,GACpC,IAAIE,EAAM,EACVD,EAAaC,KAAS,EACtBD,EAAaE,IAAI7B,EAAM4B,GAAMA,GAAO5B,EAAKT,OACzCoC,EAAaE,IAAI3B,EAAI0B,GAAMA,GAAO1B,EAAGX,OACrCoC,EAAaC,KAASV,GAAa,GACnCS,EAAaC,KAAUV,GAAa,GAAM,IAC1CS,EAAaC,KAAUV,GAAa,EAAK,IACzCS,EAAaC,KAAqB,IAAZV,EACtBS,EAAaE,IAAIJ,EAAaG,GAAMA,GAAOH,EAAYlC,OAEvD,MAAMuC,EAASH,EAAa1B,SAAS,EAAG2B,GAExC,IAAIvB,EACJ,IACIA,QAAa9C,EAAawE,KACtB,CAAElB,KAAM,QACRN,EACAuB,GAEN,MAAO3F,GACL,MAAMyB,EAAc,6BAA+BzB,EAAG2B,KAG1D,MAAMkE,EAAY,IAAIzD,WAAW8B,GAEjC,OADAsB,EAAaE,IAAIG,EAAWJ,GA8IhC,SAA2B3D,GAGvB,MACMgE,EAASC,KAAKC,KAAKlE,EAAKsB,OADT,IAEf6C,EAAQ,IAAIC,MAAMJ,EAAS,GACjCG,EAAM,GAAKrD,EACX,IACIS,EADA8C,EAAI,EAER,IAAK9C,EAAI,EAAGA,GAAKyC,EAAQzC,IACrB4C,EAAM5C,GAAK+C,EAAatE,EAAKgC,SAASqC,EAAGA,EAPxB,KAQjBA,GARiB,GAYrB,OAFAF,EAAM5C,KA9EW,oCA+EjB4C,EAAM5C,GAAK,IACH,IAAI8B,aAAcC,OAAOa,EAAMI,KAAK,OAAQC,OA5J7CC,CAAkBf,GAW7B5D,eAAeyC,EAAWR,EAAkBG,EAAoBjC,GAC5D,MAAMyE,EAAQ,IAAIC,KAElB,IAAIC,EAaAC,EAZJ,IACID,QAAYtF,EAAawF,UACrB,OACA,IAAIzB,aAAcC,OAAOrD,GACzB,CAAE2C,KAAM,WACR,EACA,CAAC,eAEP,MAAO1E,GACL,MAAMyB,EAAc,kCAAoCzB,EAAG2B,KAI/D,IACIgF,QAAgBvF,EAAayF,WACzB,CACInC,KAAM,SACNb,KAAMA,EACNG,WAAYA,EACZ8C,KAAM,WAEVJ,EACA,KAEN,MAAO1G,GACL,MAAMyB,EAAc,mCAAqCzB,EAAG2B,KAGhE,MAAMoF,EAAM,IAAIN,KAChBxG,IAAO+G,IAAI,uCAAyCD,EAAIE,UAAYT,EAAMS,WAAa,MAEvF,MAAM9C,EAASwC,EAAQjE,MAAM,EAAG,IAC1B0B,EAAUuC,EAAQjE,MAAM,IAExBwE,EAAU9F,EAAawF,UACzB,MACAzC,EACA,CAAEO,KAAM,YACR,EACA,CAAC,UAAW,YACd3E,MAAOC,IACL,MAAMyB,EAAc,8CAAgDzB,EAAG2B,OAGrEwF,EAAW/F,EAAawF,UAC1B,MACAxC,EACA,CACIM,KAAM,OACNoC,KAAM,CAAEpC,KAAM,aAElB,EACA,CAAC,OAAQ,WACX3E,MAAOC,IACL,MAAMyB,EAAc,+CAAiDzB,EAAG2B,OAG5E,OAAO3C,QAAQoI,IAAI,CAACF,EAASC,IAGjC,MAAMvE,EAAc,sCAyFpB,SAASwD,EAAajD,GAGlB,MAAMF,EAAeoE,OAAOC,aAAaC,MAAM,KAAMrB,MAAMsB,KAAKrE,IAEhE,OAAO9B,OAAOoG,KAAKxE","file":"bundles/91088212bc241f36c0c9/6.js","sourceRoot":""}